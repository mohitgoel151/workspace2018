package leetcode.biweekly._16;

import java.util.Arrays;
import java.util.List;

public class Tree {

    public static void main(String[] args) {

        // E23","2X2","12S

        System.out.println(pathsWithMaxScore(Arrays.asList("E11", "XXX", "11S")));// "E11","XXX","11S")));

        System.out.println(pathsWithMaxScore(Arrays.asList(
                "E999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999S")));

    }

    public static int[] pathsWithMaxScore(List<String> board) {
        // public int[] pathsWithMaxScore(List<String> board) {
        int rows = board.size();
        int columns = rows;

        Point[][] result = new Point[rows][columns];

        result[rows - 1][columns - 1] = new Point(0, 1);

        for (int col = columns - 2; col >= 0; col--) {
            if (board.get(rows - 1).charAt(col) == 'X') {
                result[rows - 1][col] = new Point(Integer.MIN_VALUE, 0);
                continue;
            }
            int lastPaths = result[rows - 1][col + 1].sum == Integer.MIN_VALUE ? 0 : 1;
            int sum = result[rows - 1][col + 1].sum == Integer.MIN_VALUE ? Integer.MIN_VALUE : Integer.parseInt(String.valueOf(board.get(rows - 1).charAt(col))) + result[rows - 1][col + 1].sum;

            if (lastPaths < 0) {
                System.out.println("paths = " + lastPaths);
            }

            result[rows - 1][col] = new Point(sum, lastPaths);
        }

        for (int row = rows - 2; row >= 0; row--) {
            if (board.get(row).charAt(columns - 1) == 'X') {
                result[row][columns - 1] = new Point(Integer.MIN_VALUE, 0);
                continue;
            }
            int lastPaths = result[row + 1][columns - 1].sum == Integer.MIN_VALUE ? 0 : 1;
            int sum = result[row + 1][columns - 1].sum == Integer.MIN_VALUE ? Integer.MIN_VALUE
                    : Integer.parseInt(String.valueOf(board.get(row).charAt(columns - 1))) + result[row + 1][columns - 1].sum;

            if (lastPaths < 0) {
                System.out.println("paths = " + lastPaths);
            }

            result[row][columns - 1] = new Point(sum, lastPaths);
        }

        for (int row = rows - 2; row >= 0; row--) {
            for (int col = columns - 2; col >= 0; col--) {

                if (board.get(row).charAt(col) == 'X') {
                    result[row][col] = new Point(Integer.MIN_VALUE, 0);
                    continue;
                }

                int val = 0;

                if (!(row == 0 && col == 0)) {
                    val = Integer.parseInt(String.valueOf(board.get(row).charAt(col)));
                }

                int max = Math.max(result[row + 1][col].sum, Math.max(result[row + 1][col + 1].sum, result[row][col + 1].sum));
                int paths = (max == result[row + 1][col].sum) ? result[row + 1][col].paths : 0;
                paths += (max == result[row + 1][col + 1].sum) ? result[row + 1][col + 1].paths : 0;
                paths += (max == result[row][col + 1].sum) ? result[row][col + 1].paths : 0;
                
                paths = paths % 1000000007;

                if (paths < 0) {
                    System.out.println("paths = " + paths);
                }

                result[row][col] = new Point(max + val, paths);
            }
        }
        if (result[0][0].paths == 0) {
            return new int[] { 0, 0 };
        }
        return new int[] { result[0][0].sum, (int) result[0][0].paths };
    }

}

class Point {
    public int sum;
    public int paths;

    public Point(int s, int p) {
        sum = s;
        paths = p;
    }
}
